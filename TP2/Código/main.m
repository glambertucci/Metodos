%Benchmark

% f=@(t,x,par)[x];
% par =@(t) t>0; 
% [t,x] = miode(f,1,0,1,0.5,0.0001,par);

%x(:,1) es R 
%x(:,2) es B
%x(:,3) es C

%Figura 2 (A) - 1
Ib =@(t) t>=20 & t<=80;
par = @(t) [0 0.0001*Ib(t) 0 0 0 0];
f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
[t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
plot(t,x)
title('Figura 2 (A)-1')
grid on


% %Figura 2 (A) - 2
% Ic =@(t) t>=20 & t<=80;
% par = @(t) [0 0 0 0 0.0001*Ic(t) 0];
% f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
% [t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
% plot(t,x)
% title('Figura 2 (A)-2')
% grid on
% 
% %Figura 2 (A) - 3
% Ir =@(t) t>=20 & t<=80;
% par = @(t) [0.0001*Ir(t) 0 0 0 0 0];
% f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
% [t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
% plot(t,x)
% title('Figura 2 (A)-3')
% grid on
% 
% %Figura 2 (B) - 1
% Ib =@(t) t>=20 & t<=80;
% par = @(t) [0 -8.3e-5*Ib(t) 0 0 0 0];
% f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
% [t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
% plot(t,x)
% title('Figura 2 (B)-1')
% grid on
% 
% %Figura 2 (B) - 2
% Ic =@(t) t>=20 & t<=80;
% par = @(t) [0 0 0 0 -0.00029*Ic(t) 0];
% f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
% [t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
% plot(t,x)
% title('Figura 2 (B)-2')
% grid on
% 
% %Figura 2 (B) - 3
% Ir =@(t) t>=20 & t<=80;
% par = @(t) [-0.00012*Ir(t) 0 0 0 0 0];
% f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
% [t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
% plot(t,x)
% title('Figura 2 (B)-3')
% grid on
% 
% %Figura 2 (C) - 1
% Ip =@(t) t>=20 & t<=80;
% par = @(t) [0 0 1000*Ip(t) 0 0 0];
% f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
% [t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
% plot(t,x)
% title('Figura 2 (C)-1')
% grid on
% 
% %Figura 2 (C)- 2
% I0 =@(t) t>=20 & t<=80;
% par = @(t) [0 0 0 0 0 2.5e5*I0(t)];
% f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
% [t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
% plot(t,x)
% title('Figura 2 (C)-2')
% grid on
% 
% %Figura 2 (C) - 3
% Il =@(t) t>=20 & t<=140;
% I0 =@(t) t>=80 & t<=140;
% par = @(t) [0 ,0 ,0 ,1e4*Il(t), 0, 9e4*I0(t)];
% f=@(t,x,par)[7e-4*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))-0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)+par(:,1) ,0.035*((x(:,3)+5e-3)/(x(:,3)+2.5e-4))*x(:,1)-0.189*x(:,2)+par(:,2),2.1e-3*((102352.9412)*((((par(:,3)/86)+(125/43))/((par(:,3)/86)+150))*x(:,2)*(1+(par(:,4)/1e3))/(1+(29/85)+(1/350)*((2e5*((par(:,3)/86)+150)*x(:,1))/((par(:,3)/86)+(125/43))+par(:,6)))))-0.7*((x(:,3)+2.5e-4)/(x(:,3)+5e-3))*x(:,3)+par(:,5)];
% [t,x] = miode(f,[0.0007734,0.0007282,0.0009127],0,140,1,1e-6,par);
% plot(t,x)
% title('Figura 2 (C)-3')
% grid on